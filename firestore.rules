rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Helper to check if user is signed in
    function isAuthenticated() {
      return request.auth != null;
    }

    // Users: Authenticated users can read/write their own profile
    // Admins (checked via client logic for now, or add admin claim) can read all
    match /users/{userId} {
      allow read, write: if isAuthenticated();
    }

    // Components: Authenticated users can read, only Admins can write
    // (For simplicity in this stage, we allow authenticated write to let you seed data easily, 
    // or you can restrict it if you have the Admin role setup working perfectly)
    match /components/{componentId} {
      allow read: if isAuthenticated();
      allow write: if isAuthenticated(); 
    }

    // Bookings: Authenticated users can create/read
    match /bookings/{bookingId} {
      allow read, write: if isAuthenticated();
    }

    // Orders: Authenticated users can create/read
    match /orders/{orderId} {
      allow read, write: if isAuthenticated();
    }
  }
}
